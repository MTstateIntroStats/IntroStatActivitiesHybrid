## Lecture Notes Week 3: Exploratory data analysis 

\setstretch{1}

### Summarizing categorical data {-}

* A ___________________ is calculated on data from a sample

* The parameter of interest is what we want to know from the population.

    - Includes:
    -- Population word (true, long-run, population)
    -- Summary measure (depends on the type of data)
    -- Context
    --- Observational units
    --- Variable(s)

Categorical data can be numerically summarized by calculating a _____________________________ from the data set.

    - Notation used for the population proportion:
    
    -- Single categorical variable:
       
\vspace{0.2in}
        
    -- Two categorical variables:
    
\vspace{0.2in}

        * Subscripts represent the ______________________ variable groups
    
    - Notation used for the sample proportion:
    
    -- Single categorical variable:

\vspace{0.2in}

    -- Two categorical variables
    
\vspace{0.2in}

Categorical data can be reported in a ________________ table, which plots counts or a __________________ ___________________ table, which plots the proportion.

When we have two categorical variables we report the data in a  _____________________________________  or two-way table with the __________________________________ variable on the columns and the __________________________________ variable on the rows.

Example:  Gallatin Valley is the fastest growing county in Montana.  You’ll often hear Bozeman residents complaining about the ‘out-of-staters’ moving in.  A local real estate agent recorded data on a random sample of 100 home sales over the last year at her company and noted where the buyers were moving from as well as the age of the person or average age of a couple buying a home.  The variable age was binned into two categories, "Under30" and "Over30." Additionally, the variable, state the buyers were moving from, was created as a binary variable, "Out" for a location out of state and "In" for a location in state.  

The following code reads in the data set, `moving_to_mt` and names the object moving.

```{r}
moving <- read.csv(moving_to_mt.csv)
```


The `R` function `glimpse` was used to give the following output.

```{r, echo=TRUE}
glimpse(moving_to_mt)
```

* What are the observational units in this study?

\vspace{0.3in}

* What type of variable is `Age`?

\vspace{0.3in}

* What type of variable is `Age_Group`?

To further analyze the categorical variable, `From`, we can create either a frequency table:

```{r, echo=TRUE}
moving_to_mt %>%
    count(From)
```

Or a relative frequency table:

```{r, echo=TRUE}
moving_to_mt %>%
  count(From) %>%
  mutate(freq = n/sum(n))
```

* How many buyers are from WA?  

\vspace{0.3in}

* What proportion of sampled buyers are from WA?

\vspace{0.3in}

* What notation is used for the proportion of buyers that that are from WA?

\vspace{0.3in}

* How many of the sampled buyers were under 30 years old and from Montana?

\vspace{0.3in}

To look at the relationship between the variable, `Age_Group` and the variable, `From` create the following two-way table using the `R` output below.  Note, we are using `From` as the explanatory variable to predict whether a buyer is over or under the age of 30.

```{r, echo=TRUE}
moving_to_mt %>%
    group_by(Age_Group) %>% count(From)
```

\begin{center}
\begingroup
\setlength{\tabcolsep}{14pt} % Default value: 6pt
\renewcommand{\arraystretch}{2} % Default value: 1
\begin{tabular}{|c|c|c|c|c|c|}
\hline
 & \multicolumn{4}{|c|}{\textbf{State}} & \\ \hline
\textbf{Age Group} & CA & CO & MT & WA & Total \\ \hline
 Over30 & & & & & \\ \hline
 Under30 & & & & &\\ \hline
 Total & & & & & \\ \hline  
\end{tabular}
\endgroup
\end{center}

*Using the table above, how many of sampled buyers were under 30 years old and from Montana?

\vspace{0.2in}

If we want to know what proportion of each age group is from each state, we would calculate the proportion of buyers from each ________________ from each ___________________. In other words, divide the number of buyers from each state that are over 30 by the total for row 1, the total number of buyers over 30.

Fill in the following table, to find the row proportions.

\begin{center}
\begingroup
\setlength{\tabcolsep}{14pt} % Default value: 6pt
\renewcommand{\arraystretch}{2} % Default value: 1
\begin{tabular}{|c|c|c|c|c|}
\hline
 & \multicolumn{4}{|c|}{\textbf{State}} & \\ \hline
\textbf{Age Group} & CA & CO & MT & WA  \\ \hline
 Over30 & & & &  \\ \hline
 Under30 & & & & \\ \hline
\end{tabular}
\endgroup
\end{center}

* what proportion of under 30-year-old sampled buyers were from California?

\vspace{0.3in}

What notation should be used for this value?

\vspace{0.2in}

Additionally, we could find the proportion of buyers in each state for each age group.  Here we would calculate the proportion of buyers in each ________________________ for each _____________________.  Divide the number of buyers in each age group from CA by the total for column 1, the total number of buyers from CA. 

Fill in the following table, to find the column proportions.

\begin{center}
\begingroup
\setlength{\tabcolsep}{14pt} % Default value: 6pt
\renewcommand{\arraystretch}{2} % Default value: 1
\begin{tabular}{|c|c|c|c|c|}
\hline
 & \multicolumn{4}{|c|}{\textbf{State}} & \\ \hline
\textbf{Age Group} & CA & CO & MT & WA  \\ \hline
 Over30 & & & &  \\ \hline
 Under30 & & & & \\ \hline
\end{tabular}
\endgroup
\end{center}

* What does the value 0.770 represent?

\vspace{0.3in}

#### Displaying categorical variables {-}

* Types of plots for a single categorical variable

\vspace{0.4in}

* Types of plots for two categorical variables

\vspace{0.4in}

The following code in `R` will create a frequency bar plot of the variable, `From`.

```{r, echo=TRUE}
moving_to_mt %>%
    ggplot(aes(x = From))+
    geom_bar(stat = "count") +
    labs(title = "Frequency Bar Plot of State of Origin",
       y = "Frequency",
       x = "State of Origin")
```

* What can we see from this plot?

\vspace{0.3in}

Additionally, we can create a relative frequency bar plot.

```{r, echo=TRUE}
moving_to_mt %>%
  ggplot(aes(x = From))+
  geom_bar(aes(y = ..prop.., group = 1)) +
  labs(title = "Relative Frequency Bar Plot of State of Origin",
       y = "Relative Frequency",
       x = "State of Origin")
```

* Note: the x-axis is the _______________ between the frequency bar plot and the relative frequency bar plot.  However, the ______________ differs.  The scale for the frequency bar plot goes from _______________________________ and the scale for the relative frequency bar plot is from ______________________________.

In a segmented bar plot, the bar for each category will sum to 1.  In this first plot, we are plotting the row proportions calculated conditional on the age group.

```{r, echo=TRUE}
moving_to_mt%>%
  ggplot(aes(x = Age_Group, fill = From))+
  geom_bar(stat = "count", position = "fill") +
  labs(title = "Segmented bar plot of Age Group of Buyers, Segmented by State of Origin",
       y = "Relative Frequency",
       x = "Age Group") +
  scale_fill_grey()
```



\newpage
